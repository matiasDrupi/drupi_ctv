<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Formulario Drupi</title>

<!-- Fuentes -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;500&display=swap" rel="stylesheet" />
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<link href="https://api.fontshare.com/v2/css?f[]=switzer@400,500,600,700&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    font-family: 'Roboto', sans-serif;
    background: #f5f5f5;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  header {
    background: #000;
    width: 100%;
    padding: 1rem 0;
    text-align: center;
  }
  header h1 {
    margin: 0;
    font-family: 'Switzer', sans-serif;
    font-size: 32px;
    font-weight: 600;
    color: #ededed;
  }
  header h2 {
    margin: 0;
    font-family: 'Switzer', sans-serif;
    font-size: 15px;
    font-weight: 600;
    color: #ededed;
  }
  .container {
    background: #fff;
    margin-top: 2rem;
    padding: 2rem;
    border-radius: 1rem;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    width: 90%;
    max-width: 600px;
  }
  input, select, textarea, button {
    width: 100%;
    padding: 0.8rem;
    margin: 0.5rem 0;
    border-radius: 0.5rem;
    border: 1px solid #ccc;
  }
  button {
    background: #000;
    color: white;
    font-weight: bold;
    cursor: pointer;
  }
</style>

</head>
<body>

<header>
  <h1>Drupi</h1>
  <h2>CTV</h2>
</header>

<div class="container">
  <form id="formulario">

    <label>Título (Máximo 2 líneas - 35 caracteres)</label>
    <input type="text" name="titulo" placeholder="Escribí el título..." maxlength="35" required>

    <label>Color del Título</label>
    <select name="colorTitulo" required></select>

    <label>Bajada (Máximo 5 líneas - 120 caracteres)</label>
    <textarea name="bajada" placeholder="Escribí la bajada..." maxlength="120" rows="5" required></textarea>

    <label>Color de la Bajada</label>
    <select name="colorBajada" required></select>

    <label>Color de Fondo</label>
    <select name="colorFondo" required></select>

    <label>Link del video de Instagram</label>
    <input type="url" name="linkInstagram" placeholder="https://www.instagram.com/..." required>

    <button type="submit">Enviar</button>
  </form>
</div>

<script>
	
	const urlParams = new URLSearchParams(window.location.search);
  const token = urlParams.get('token');

  if (!token) {
    document.body.innerHTML = '<h1>Acceso denegado</h1>';
  } else {
    fetch(`https://script.google.com/macros/s/AKfycbyvJqV1NWZKD8EZ3ZEK0EGVi0nloHk198_UlldZr74JpIFpc8ajYRQeslT9R0yG4MLS/exec?token=${token}`)
      .then(response => response.json())
      .then(data => {
        if(data.status === "ok") {
          document.body.innerHTML = `
            <h1>Formulario</h1>
            <form>
              <!-- acá va tu formulario real -->
            </form>
          `;
        } else {
          document.body.innerHTML = '<h1>Acceso denegado</h1>';
        }
      });
  }
	
  const colores = [
    'Rojo', 'Naranja', 'Amarillo', 'Verde', 'Celeste', 'Azul', 'Violeta', 'Rosa',
    'Marrón', 'Gris', 'Negro', 'Blanco', 'Dorado', 'Plateado', 'Turquesa', 'Coral',
    'Fucsia', 'Verde Lima', 'Azul Marino', 'Beige'
  ];

  document.querySelectorAll('select').forEach(select => {
    select.innerHTML = '<option value="" disabled selected>Elegí un color</option>' + colores.map(color => `<option value="${color}">${color}</option>`).join('');
  });

  document.getElementById('formulario').addEventListener('submit', function(e) {
  e.preventDefault();

  // Obtener el contenido del h2
  const h2Content = document.querySelector('header h2').textContent;

  // Recopilar datos del formulario
  const formData = new FormData(this);
  formData.append('h2Content', h2Content); // Agregar el contenido del h2

  // Convertir FormData a un objeto simple
  const data = Object.fromEntries(formData.entries());

  // Enviar los datos al webhook
  fetch('https://hook.us2.make.com/p0bmy67fwppdcsmr6f2vmp4mlw15vhvo', {
    method: 'POST',
    body: JSON.stringify(data),
    headers: {
      'Content-Type': 'application/json'
    }
  }).then(response => {
    if(response.ok){
      alert('Formulario enviado correctamente');
      this.reset();
    } else {
      alert('Error al enviar el formulario');
    }
  }).catch(error => {
    console.error('Error:', error);
    alert('Error al enviar el formulario');
  });
});

</script>

</body>
</html>
